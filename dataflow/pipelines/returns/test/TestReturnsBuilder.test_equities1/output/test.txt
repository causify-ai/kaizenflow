################################################################################
config
################################################################################
load_prices:
  source_node_name: FunctionDataSource
  source_node_kwargs:
    func: <function load_data_from_disk>
    func_kwargs:
      file_path: s3://alphamatic-data/data/kibot/pq/sp_500_1min/AAPL.pq
      aws_profile: am
      start_date: 2010-01-04 09:30:00
      end_date: 2010-01-04 16:05:00
filter_weekends:
  col_mode: replace_all
filter_ath:
  col_mode: replace_all
  transformer_kwargs:
    start_time: 09:30:00
    end_time: 16:00:00
resample_prices_to_1min:
  func_kwargs:
    rule: 1T
    price_cols: ['close']
    volume_cols: ['vol']
compute_vwap:
  func_kwargs:
    rule: 5T
    price_col: close
    volume_col: vol
    add_bar_start_timestamps: True
    add_epoch: True
    add_last_price: True
compute_ret_0:
  cols: ['twap', 'vwap']
  col_mode: merge_all
  transformer_kwargs:
    mode: pct_change
################################################################################
df_out
################################################################################
                          vwap    twap   last bar_start_timestamp    minute  twap_ret_0  vwap_ret_0
datetime                                                                                           
2010-01-04 09:30:00        NaN     NaN    NaN 2010-01-04 09:25:00  21043290         NaN         NaN
2010-01-04 09:35:00  26.354942  26.350  26.39 2010-01-04 09:30:00  21043295         NaN         NaN
2010-01-04 09:40:00  26.406202  26.408  26.45 2010-01-04 09:35:00  21043300    0.002201    0.001945
2010-01-04 09:45:00  26.423782  26.426  26.39 2010-01-04 09:40:00  21043305    0.000682    0.000666
2010-01-04 09:50:00  26.343312  26.352  26.34 2010-01-04 09:45:00  21043310   -0.002800   -0.003045
2010-01-04 09:55:00  26.287632  26.290  26.29 2010-01-04 09:50:00  21043315   -0.002353   -0.002114
2010-01-04 10:00:00  26.321200  26.318  26.34 2010-01-04 09:55:00  21043320    0.001065    0.001277
2010-01-04 10:05:00  26.335235  26.336  26.31 2010-01-04 10:00:00  21043325    0.000684    0.000533
2010-01-04 10:10:00  26.271883  26.276  26.25 2010-01-04 10:05:00  21043330   -0.002278   -0.002406
2010-01-04 10:15:00  26.279456  26.276  26.31 2010-01-04 10:10:00  21043335    0.000000    0.000288
2010-01-04 10:20:00  26.269847  26.278  26.23 2010-01-04 10:15:00  21043340    0.000076   -0.000366
2010-01-04 10:25:00  26.261252  26.258  26.29 2010-01-04 10:20:00  21043345   -0.000761   -0.000327
2010-01-04 10:30:00  26.344942  26.346  26.36 2010-01-04 10:25:00  21043350    0.003351    0.003187
2010-01-04 10:35:00  26.349885  26.350  26.35 2010-01-04 10:30:00  21043355    0.000152    0.000188
2010-01-04 10:40:00  26.353431  26.350  26.34 2010-01-04 10:35:00  21043360    0.000000    0.000135
2010-01-04 10:45:00  26.354566  26.354  26.35 2010-01-04 10:40:00  21043365    0.000152    0.000043
2010-01-04 10:50:00  26.352881  26.354  26.35 2010-01-04 10:45:00  21043370    0.000000   -0.000064
2010-01-04 10:55:00  26.382736  26.378  26.38 2010-01-04 10:50:00  21043375    0.000911    0.001133
2010-01-04 11:00:00  26.354353  26.358  26.34 2010-01-04 10:55:00  21043380   -0.000758   -0.001076
2010-01-04 11:05:00  26.330467  26.332  26.31 2010-01-04 11:00:00  21043385   -0.000986   -0.000906
2010-01-04 11:10:00  26.316017  26.318  26.33 2010-01-04 11:05:00  21043390   -0.000532   -0.000549
2010-01-04 11:15:00  26.313482  26.314  26.31 2010-01-04 11:10:00  21043395   -0.000152   -0.000096
2010-01-04 11:20:00  26.313599  26.316  26.31 2010-01-04 11:15:00  21043400    0.000076    0.000004
2010-01-04 11:25:00  26.334501  26.334  26.33 2010-01-04 11:20:00  21043405    0.000684    0.000794
2010-01-04 11:30:00  26.334982  26.336  26.34 2010-01-04 11:25:00  21043410    0.000076    0.000018
2010-01-04 11:35:00  26.364641  26.360  26.37 2010-01-04 11:30:00  21043415    0.000911    0.001126
2010-01-04 11:40:00  26.380000  26.380  26.38 2010-01-04 11:35:00  21043420    0.000759    0.000583
2010-01-04 11:45:00  26.371067  26.374  26.36 2010-01-04 11:40:00  21043425   -0.000227   -0.000339
2010-01-04 11:50:00  26.396647  26.386  26.41 2010-01-04 11:45:00  21043430    0.000455    0.000970
2010-01-04 11:55:00  26.407131  26.406  26.40 2010-01-04 11:50:00  21043435    0.000758    0.000397
2010-01-04 12:00:00  26.400000  26.400  26.40 2010-01-04 11:55:00  21043440   -0.000227   -0.000270
2010-01-04 12:05:00  26.397102  26.398  26.40 2010-01-04 12:00:00  21043445   -0.000076   -0.000110
2010-01-04 12:10:00  26.388294  26.392  26.38 2010-01-04 12:05:00  21043450   -0.000227   -0.000334
2010-01-04 12:15:00  26.399993  26.398  26.41 2010-01-04 12:10:00  21043455    0.000227    0.000443
2010-01-04 12:20:00  26.415345  26.410  26.42 2010-01-04 12:15:00  21043460    0.000455    0.000582
2010-01-04 12:25:00  26.425638  26.426  26.43 2010-01-04 12:20:00  21043465    0.000606    0.000390
2010-01-04 12:30:00  26.440000  26.440  26.44 2010-01-04 12:25:00  21043470    0.000530    0.000543
2010-01-04 12:35:00  26.436388  26.434  26.44 2010-01-04 12:30:00  21043475   -0.000227   -0.000137
2010-01-04 12:40:00  26.432127  26.434  26.42 2010-01-04 12:35:00  21043480    0.000000   -0.000161
2010-01-04 12:45:00  26.441499  26.438  26.45 2010-01-04 12:40:00  21043485    0.000151    0.000355
2010-01-04 12:50:00  26.439334  26.440  26.44 2010-01-04 12:45:00  21043490    0.000076   -0.000082
2010-01-04 12:55:00  26.432499  26.432  26.43 2010-01-04 12:50:00  21043495   -0.000303   -0.000259
2010-01-04 13:00:00  26.420052  26.422  26.41 2010-01-04 12:55:00  21043500   -0.000378   -0.000471
2010-01-04 13:05:00  26.385482  26.386  26.39 2010-01-04 13:00:00  21043505   -0.001363   -0.001308
2010-01-04 13:10:00  26.394258  26.394  26.40 2010-01-04 13:05:00  21043510    0.000303    0.000333
2010-01-04 13:15:00  26.396256  26.396  26.39 2010-01-04 13:10:00  21043515    0.000076    0.000076
2010-01-04 13:20:00  26.412359  26.410  26.43 2010-01-04 13:15:00  21043520    0.000530    0.000610
2010-01-04 13:25:00  26.418148  26.416  26.41 2010-01-04 13:20:00  21043525    0.000227    0.000219
2010-01-04 13:30:00  26.403576  26.404  26.40 2010-01-04 13:25:00  21043530   -0.000454   -0.000552
2010-01-04 13:35:00  26.396923  26.398  26.39 2010-01-04 13:30:00  21043535   -0.000227   -0.000252
2010-01-04 13:40:00  26.398492  26.398  26.40 2010-01-04 13:35:00  21043540    0.000000    0.000059
2010-01-04 13:45:00  26.391919  26.392  26.39 2010-01-04 13:40:00  21043545   -0.000227   -0.000249
2010-01-04 13:50:00  26.384055  26.384  26.38 2010-01-04 13:45:00  21043550   -0.000303   -0.000298
2010-01-04 13:55:00  26.373755  26.372  26.37 2010-01-04 13:50:00  21043555   -0.000455   -0.000390
2010-01-04 14:00:00  26.366539  26.366  26.37 2010-01-04 13:55:00  21043560   -0.000228   -0.000274
2010-01-04 14:05:00  26.370000  26.370  26.37 2010-01-04 14:00:00  21043565    0.000152    0.000131
2010-01-04 14:10:00  26.389240  26.386  26.40 2010-01-04 14:05:00  21043570    0.000607    0.000730
2010-01-04 14:15:00  26.387457  26.390  26.39 2010-01-04 14:10:00  21043575    0.000152   -0.000068
2010-01-04 14:20:00  26.401639  26.402  26.41 2010-01-04 14:15:00  21043580    0.000455    0.000537
2010-01-04 14:25:00  26.393180  26.396  26.38 2010-01-04 14:20:00  21043585   -0.000227   -0.000320
2010-01-04 14:30:00  26.383225  26.382  26.39 2010-01-04 14:25:00  21043590   -0.000530   -0.000377
2010-01-04 14:35:00  26.404427  26.404  26.41 2010-01-04 14:30:00  21043595    0.000834    0.000804
2010-01-04 14:40:00  26.405131  26.404  26.41 2010-01-04 14:35:00  21043600    0.000000    0.000027
2010-01-04 14:45:00  26.437767  26.438  26.44 2010-01-04 14:40:00  21043605    0.001288    0.001236
2010-01-04 14:50:00  26.437200  26.436  26.42 2010-01-04 14:45:00  21043610   -0.000076   -0.000021
2010-01-04 14:55:00  26.437779  26.438  26.44 2010-01-04 14:50:00  21043615    0.000076    0.000022
2010-01-04 15:00:00  26.421552  26.422  26.41 2010-01-04 14:55:00  21043620   -0.000605   -0.000614
2010-01-04 15:05:00  26.433334  26.432  26.44 2010-01-04 15:00:00  21043625    0.000378    0.000446
2010-01-04 15:10:00  26.447271  26.446  26.44 2010-01-04 15:05:00  21043630    0.000530    0.000527
2010-01-04 15:15:00  26.433506  26.432  26.43 2010-01-04 15:10:00  21043635   -0.000529   -0.000520
2010-01-04 15:20:00  26.450425  26.446  26.46 2010-01-04 15:15:00  21043640    0.000530    0.000640
2010-01-04 15:25:00  26.454208  26.454  26.44 2010-01-04 15:20:00  21043645    0.000303    0.000143
2010-01-04 15:30:00  26.434843  26.434  26.44 2010-01-04 15:25:00  21043650   -0.000756   -0.000732
2010-01-04 15:35:00  26.442434  26.444  26.43 2010-01-04 15:30:00  21043655    0.000378    0.000287
2010-01-04 15:40:00  26.433823  26.434  26.43 2010-01-04 15:35:00  21043660   -0.000378   -0.000326
2010-01-04 15:45:00  26.425023  26.426  26.44 2010-01-04 15:40:00  21043665   -0.000303   -0.000333
2010-01-04 15:50:00  26.447729  26.446  26.45 2010-01-04 15:45:00  21043670    0.000757    0.000859
2010-01-04 15:55:00  26.452012  26.452  26.45 2010-01-04 15:50:00  21043675    0.000227    0.000162
2010-01-04 16:00:00  26.442146  26.440  26.45 2010-01-04 15:55:00  21043680   -0.000454   -0.000373
2010-01-04 16:05:00        NaN     NaN    NaN 2010-01-04 16:00:00  21043685         NaN         NaN
