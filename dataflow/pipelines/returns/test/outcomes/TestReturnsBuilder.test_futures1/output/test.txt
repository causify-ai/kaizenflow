################################################################################
config
################################################################################
load_prices:
  source_node_name: FunctionDataSource
  source_node_kwargs:
    func: <function load_kibot_data>
    func_kwargs:
      frequency: T
      contract_type: continuous
      symbol: ES
      start_date: 2010-01-04 09:00:00
      end_date: 2010-01-04 16:30:00
filter_weekends:
  col_mode: replace_all
filter_ath:
  col_mode: replace_all
  transformer_kwargs:
    start_time: 09:30:00
    end_time: 16:00:00
resample_prices_to_1min:
  func_kwargs:
    rule: 1T
    price_cols: ['close']
    volume_cols: ['vol']
compute_vwap:
  func_kwargs:
    rule: 5T
    price_col: close
    volume_col: vol
    add_bar_start_timestamps: True
    add_epoch: True
    add_last_price: True
compute_ret_0:
  cols: ['twap', 'vwap']
  col_mode: merge_all
  transformer_kwargs:
    mode: pct_change
################################################################################
df_out
################################################################################
                            vwap     twap     last bar_start_timestamp    minute  twap_ret_0  vwap_ret_0
datetime                                                                                                
2010-01-04 09:00:00          NaN      NaN      NaN 2010-01-04 08:55:00  21043260         NaN         NaN
2010-01-04 09:05:00          NaN      NaN      NaN 2010-01-04 09:00:00  21043265         NaN         NaN
2010-01-04 09:10:00          NaN      NaN      NaN 2010-01-04 09:05:00  21043270         NaN         NaN
2010-01-04 09:15:00          NaN      NaN      NaN 2010-01-04 09:10:00  21043275         NaN         NaN
2010-01-04 09:20:00          NaN      NaN      NaN 2010-01-04 09:15:00  21043280         NaN         NaN
2010-01-04 09:25:00          NaN      NaN      NaN 2010-01-04 09:20:00  21043285         NaN         NaN
2010-01-04 09:30:00          NaN      NaN      NaN 2010-01-04 09:25:00  21043290         NaN         NaN
2010-01-04 09:35:00  1120.790083  1120.45  1121.75 2010-01-04 09:30:00  21043295         NaN         NaN
2010-01-04 09:40:00  1122.404000  1122.30  1123.00 2010-01-04 09:35:00  21043300    0.001651    0.001440
2010-01-04 09:45:00  1123.811204  1123.10  1124.50 2010-01-04 09:40:00  21043305    0.000713    0.001254
2010-01-04 09:50:00  1124.856278  1124.85  1124.75 2010-01-04 09:45:00  21043310    0.001558    0.000930
2010-01-04 09:55:00  1123.868871  1123.95  1123.50 2010-01-04 09:50:00  21043315   -0.000800   -0.000878
2010-01-04 10:00:00  1124.317477  1124.15  1124.50 2010-01-04 09:55:00  21043320    0.000178    0.000399
2010-01-04 10:05:00  1124.294760  1124.25  1124.50 2010-01-04 10:00:00  21043325    0.000089   -0.000020
2010-01-04 10:10:00  1124.660225  1124.70  1124.25 2010-01-04 10:05:00  21043330    0.000400    0.000325
2010-01-04 10:15:00  1124.515860  1124.55  1124.50 2010-01-04 10:10:00  21043335   -0.000133   -0.000128
2010-01-04 10:20:00  1124.479410  1124.45  1124.50 2010-01-04 10:15:00  21043340   -0.000089   -0.000032
2010-01-04 10:25:00  1124.769495  1124.70  1125.00 2010-01-04 10:20:00  21043345    0.000222    0.000258
2010-01-04 10:30:00  1126.488551  1126.30  1127.00 2010-01-04 10:25:00  21043350    0.001423    0.001528
2010-01-04 10:35:00  1126.744658  1126.75  1126.75 2010-01-04 10:30:00  21043355    0.000400    0.000227
2010-01-04 10:40:00  1126.885347  1126.95  1127.00 2010-01-04 10:35:00  21043360    0.000178    0.000125
2010-01-04 10:45:00  1127.272229  1127.20  1127.00 2010-01-04 10:40:00  21043365    0.000222    0.000343
2010-01-04 10:50:00  1127.273493  1127.30  1127.50 2010-01-04 10:45:00  21043370    0.000089    0.000001
2010-01-04 10:55:00  1127.750013  1127.65  1127.50 2010-01-04 10:50:00  21043375    0.000310    0.000423
2010-01-04 11:00:00  1127.158961  1127.30  1127.25 2010-01-04 10:55:00  21043380   -0.000310   -0.000524
2010-01-04 11:05:00  1127.250145  1127.20  1127.00 2010-01-04 11:00:00  21043385   -0.000089    0.000081
2010-01-04 11:10:00  1127.567654  1127.50  1127.50 2010-01-04 11:05:00  21043390    0.000266    0.000282
2010-01-04 11:15:00  1127.420423  1127.40  1127.25 2010-01-04 11:10:00  21043395   -0.000089   -0.000131
2010-01-04 11:20:00  1127.394634  1127.40  1127.50 2010-01-04 11:15:00  21043400    0.000000   -0.000023
2010-01-04 11:25:00  1128.154731  1128.05  1128.00 2010-01-04 11:20:00  21043405    0.000577    0.000674
2010-01-04 11:30:00  1128.123456  1128.10  1128.25 2010-01-04 11:25:00  21043410    0.000044   -0.000028
2010-01-04 11:35:00  1128.610916  1128.55  1128.50 2010-01-04 11:30:00  21043415    0.000399    0.000432
2010-01-04 11:40:00  1128.585724  1128.60  1128.50 2010-01-04 11:35:00  21043420    0.000044   -0.000022
2010-01-04 11:45:00  1129.073356  1129.00  1128.75 2010-01-04 11:40:00  21043425    0.000354    0.000432
2010-01-04 11:50:00  1128.843874  1128.85  1128.75 2010-01-04 11:45:00  21043430   -0.000133   -0.000203
2010-01-04 11:55:00  1128.925764  1128.95  1128.75 2010-01-04 11:50:00  21043435    0.000089    0.000073
2010-01-04 12:00:00  1128.688962  1128.80  1128.75 2010-01-04 11:55:00  21043440   -0.000133   -0.000210
2010-01-04 12:05:00  1128.382188  1128.45  1128.50 2010-01-04 12:00:00  21043445   -0.000310   -0.000272
2010-01-04 12:10:00  1128.743393  1128.70  1128.50 2010-01-04 12:05:00  21043450    0.000222    0.000320
2010-01-04 12:15:00  1128.524418  1128.60  1128.50 2010-01-04 12:10:00  21043455   -0.000089   -0.000194
2010-01-04 12:20:00  1128.593472  1128.60  1128.75 2010-01-04 12:15:00  21043460    0.000000    0.000061
2010-01-04 12:25:00  1128.739226  1128.70  1128.75 2010-01-04 12:20:00  21043465    0.000089    0.000129
2010-01-04 12:30:00  1128.773161  1128.80  1128.75 2010-01-04 12:25:00  21043470    0.000089    0.000030
2010-01-04 12:35:00  1128.965790  1128.90  1129.00 2010-01-04 12:30:00  21043475    0.000089    0.000171
2010-01-04 12:40:00  1129.029457  1129.00  1128.75 2010-01-04 12:35:00  21043480    0.000089    0.000056
2010-01-04 12:45:00  1129.119980  1129.10  1129.25 2010-01-04 12:40:00  21043485    0.000089    0.000080
2010-01-04 12:50:00  1129.085801  1129.20  1129.00 2010-01-04 12:45:00  21043490    0.000089   -0.000030
2010-01-04 12:55:00  1128.862431  1128.90  1128.75 2010-01-04 12:50:00  21043495   -0.000266   -0.000198
2010-01-04 13:00:00  1128.941169  1128.90  1129.00 2010-01-04 12:55:00  21043500    0.000000    0.000070
2010-01-04 13:05:00  1128.762436  1128.80  1129.00 2010-01-04 13:00:00  21043505   -0.000089   -0.000158
2010-01-04 13:10:00  1128.988269  1128.95  1129.00 2010-01-04 13:05:00  21043510    0.000133    0.000200
2010-01-04 13:15:00  1128.951516  1128.85  1128.75 2010-01-04 13:10:00  21043515   -0.000089   -0.000033
2010-01-04 13:20:00  1129.081408  1129.10  1129.25 2010-01-04 13:15:00  21043520    0.000221    0.000115
2010-01-04 13:25:00  1129.284753  1129.30  1129.25 2010-01-04 13:20:00  21043525    0.000177    0.000180
2010-01-04 13:30:00  1129.506938  1129.55  1129.50 2010-01-04 13:25:00  21043530    0.000221    0.000197
2010-01-04 13:35:00  1129.212827  1129.30  1129.00 2010-01-04 13:30:00  21043535   -0.000221   -0.000260
2010-01-04 13:40:00  1129.209191  1129.10  1129.00 2010-01-04 13:35:00  21043540   -0.000177   -0.000003
2010-01-04 13:45:00  1129.097096  1129.10  1129.00 2010-01-04 13:40:00  21043545    0.000000   -0.000099
2010-01-04 13:50:00  1128.775062  1128.80  1128.75 2010-01-04 13:45:00  21043550   -0.000266   -0.000285
2010-01-04 13:55:00  1127.916172  1127.80  1127.75 2010-01-04 13:50:00  21043555   -0.000886   -0.000761
2010-01-04 14:00:00  1127.623829  1127.60  1127.75 2010-01-04 13:55:00  21043560   -0.000177   -0.000259
2010-01-04 14:05:00  1127.877466  1127.85  1127.75 2010-01-04 14:00:00  21043565    0.000222    0.000225
2010-01-04 14:10:00  1127.972621  1127.95  1127.75 2010-01-04 14:05:00  21043570    0.000089    0.000084
2010-01-04 14:15:00  1127.935240  1127.90  1128.00 2010-01-04 14:10:00  21043575   -0.000044   -0.000033
2010-01-04 14:20:00  1127.969926  1127.90  1127.75 2010-01-04 14:15:00  21043580    0.000000    0.000031
2010-01-04 14:25:00  1127.744651  1127.75  1127.50 2010-01-04 14:20:00  21043585   -0.000133   -0.000200
2010-01-04 14:30:00  1127.844136  1127.95  1128.25 2010-01-04 14:25:00  21043590    0.000177    0.000088
2010-01-04 14:35:00  1128.531594  1128.55  1128.50 2010-01-04 14:30:00  21043595    0.000532    0.000610
2010-01-04 14:40:00  1128.279205  1128.30  1128.25 2010-01-04 14:35:00  21043600   -0.000222   -0.000224
2010-01-04 14:45:00  1128.935677  1128.85  1129.00 2010-01-04 14:40:00  21043605    0.000487    0.000582
2010-01-04 14:50:00  1129.312073  1129.30  1129.00 2010-01-04 14:45:00  21043610    0.000399    0.000333
2010-01-04 14:55:00  1129.047041  1129.10  1129.25 2010-01-04 14:50:00  21043615   -0.000177   -0.000235
2010-01-04 15:00:00  1128.499515  1128.75  1128.25 2010-01-04 14:55:00  21043620   -0.000310   -0.000485
2010-01-04 15:05:00  1129.025787  1128.90  1129.25 2010-01-04 15:00:00  21043625    0.000133    0.000466
2010-01-04 15:10:00  1129.329032  1129.40  1129.50 2010-01-04 15:05:00  21043630    0.000443    0.000269
2010-01-04 15:15:00  1128.906392  1129.05  1128.75 2010-01-04 15:10:00  21043635   -0.000310   -0.000374
2010-01-04 15:20:00  1128.798556  1128.80  1129.00 2010-01-04 15:15:00  21043640   -0.000221   -0.000096
2010-01-04 15:25:00  1128.391113  1128.55  1128.25 2010-01-04 15:20:00  21043645   -0.000221   -0.000361
2010-01-04 15:30:00  1128.500000  1128.50  1128.50 2010-01-04 15:25:00  21043650   -0.000044    0.000096
2010-01-04 15:35:00  1128.309475  1128.30  1128.00 2010-01-04 15:30:00  21043655   -0.000177   -0.000169
2010-01-04 15:40:00  1127.794209  1127.85  1127.50 2010-01-04 15:35:00  21043660   -0.000399   -0.000457
2010-01-04 15:45:00  1128.125698  1128.00  1128.50 2010-01-04 15:40:00  21043665    0.000133    0.000294
2010-01-04 15:50:00  1128.815086  1128.80  1129.00 2010-01-04 15:45:00  21043670    0.000709    0.000611
2010-01-04 15:55:00  1128.597594  1128.65  1128.50 2010-01-04 15:50:00  21043675   -0.000133   -0.000193
2010-01-04 16:00:00  1128.641543  1128.50  1128.75 2010-01-04 15:55:00  21043680   -0.000133    0.000039
2010-01-04 16:05:00          NaN      NaN      NaN 2010-01-04 16:00:00  21043685         NaN         NaN
2010-01-04 16:10:00          NaN      NaN      NaN 2010-01-04 16:05:00  21043690         NaN         NaN
2010-01-04 16:15:00          NaN      NaN      NaN 2010-01-04 16:10:00  21043695         NaN         NaN
2010-01-04 16:20:00          NaN      NaN      NaN 2010-01-04 16:15:00  21043700         NaN         NaN
2010-01-04 16:25:00          NaN      NaN      NaN 2010-01-04 16:20:00  21043705         NaN         NaN
2010-01-04 16:30:00          NaN      NaN      NaN 2010-01-04 16:25:00  21043710         NaN         NaN
