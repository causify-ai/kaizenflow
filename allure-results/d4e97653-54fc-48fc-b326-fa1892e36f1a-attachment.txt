17:36:40 - [36mINFO [0m hunit_test.py setUp:912            
################################################################################
TestDownloadRealtimeForOneExchangePeriodically1.test_amount_of_downloads
################################################################################
17:36:45 - [31mERROR[0m hsystem.py _system:274             
################################################################################
cmd='(im_v2/talos/data/extract/download_realtime_for_one_exchange_periodically.py         --data_type 'ohlcv'         --exchange_id 'binance'         --universe 'v1'         --db_stage 'dev'         --db_table 'talos_ohlcv_test'         --aws_profile 'ck'         --s3_path 's3://cryptokaizen-data-test/realtime/'         --interval_min '1'         --start_time '2022-06-28 21:36:45'         --stop_time '2022-06-28 21:37:45') 2>&1' failed with rc='1'
################################################################################
Output of the failing command is:
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[0m[36mINFO[0m: > cmd='im_v2/talos/data/extract/download_realtime_for_one_exchange_periodically.py --data_type ohlcv --exchange_id binance --universe v1 --db_stage dev --db_table talos_ohlcv_test --aws_profile ck --s3_path s3://cryptokaizen-data-test/realtime/ --interval_min 1 --start_time 2022-06-28 21:36:45 --stop_time 2022-06-28 21:37:45'
report_memory_usage=False report_cpu_usage=False
17:36:42 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:297 Delay 2.953736 sec until next iteration
17:36:45 - [36mINFO [0m extract_utils.py _download_realtime_for_one_exchange_with_timeout:251 Starting data download from: 2022-06-28 21:31:45, till: 2022-06-28 21:36:45.004762
17:36:45 - [31mERROR[0m extract_utils.py download_realtime_for_one_exchange_periodically:311 Download failed 
################################################################################
* Failed assertion *
'None' is not 'None'
datetime_='2022-06-28 21:31:45' doesn't have timezone info
################################################################################

17:36:45 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:334 Start repeat download immediately.
17:36:45 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:297 Delay 0 sec until next iteration
17:36:45 - [36mINFO [0m extract_utils.py _download_realtime_for_one_exchange_with_timeout:251 Starting data download from: 2022-06-28 21:31:45, till: 2022-06-28 21:36:45.079035
17:36:45 - [31mERROR[0m extract_utils.py download_realtime_for_one_exchange_periodically:311 Download failed 
################################################################################
* Failed assertion *
'None' is not 'None'
datetime_='2022-06-28 21:31:45' doesn't have timezone info
################################################################################

17:36:45 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:334 Start repeat download immediately.
17:36:45 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:297 Delay 0 sec until next iteration
17:36:45 - [36mINFO [0m extract_utils.py _download_realtime_for_one_exchange_with_timeout:251 Starting data download from: 2022-06-28 21:31:45, till: 2022-06-28 21:36:45.099895
17:36:45 - [31mERROR[0m extract_utils.py download_realtime_for_one_exchange_periodically:311 Download failed 
################################################################################
* Failed assertion *
'None' is not 'None'
datetime_='2022-06-28 21:31:45' doesn't have timezone info
################################################################################

17:36:45 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:334 Start repeat download immediately.
17:36:45 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:297 Delay 0 sec until next iteration
17:36:45 - [36mINFO [0m extract_utils.py _download_realtime_for_one_exchange_with_timeout:251 Starting data download from: 2022-06-28 21:31:45, till: 2022-06-28 21:36:45.120982
17:36:45 - [31mERROR[0m extract_utils.py download_realtime_for_one_exchange_periodically:311 Download failed 
################################################################################
* Failed assertion *
'None' is not 'None'
datetime_='2022-06-28 21:31:45' doesn't have timezone info
################################################################################

17:36:45 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:334 Start repeat download immediately.
17:36:45 - [36mINFO [0m extract_utils.py download_realtime_for_one_exchange_periodically:297 Delay 0 sec until next iteration
17:36:45 - [36mINFO [0m extract_utils.py _download_realtime_for_one_exchange_with_timeout:251 Starting data download from: 2022-06-28 21:31:45, till: 2022-06-28 21:36:45.140273
17:36:45 - [31mERROR[0m extract_utils.py download_realtime_for_one_exchange_periodically:311 Download failed 
################################################################################
* Failed assertion *
'None' is not 'None'
datetime_='2022-06-28 21:31:45' doesn't have timezone info
################################################################################

Traceback (most recent call last):
  File "/app/im_v2/common/data/extract/extract_utils.py", line 304, in download_realtime_for_one_exchange_periodically
    _download_realtime_for_one_exchange_with_timeout(
  File "/app/helpers/hthreading.py", line 36, in inner
    result = fn(*args, **kwargs)
  File "/app/im_v2/common/data/extract/extract_utils.py", line 256, in _download_realtime_for_one_exchange_with_timeout
    download_realtime_for_one_exchange(args, exchange_class)
  File "/app/im_v2/common/data/extract/extract_utils.py", line 193, in download_realtime_for_one_exchange
    data = exchange.download_data(
  File "/app/im_v2/common/data/extract/extractor.py", line 35, in download_data
    data = self._download_ohlcv(
  File "/app/im_v2/talos/data/extract/extractor.py", line 139, in _download_ohlcv
    return self._fetch_ohlcv(
  File "/app/im_v2/talos/data/extract/extractor.py", line 189, in _fetch_ohlcv
    params = self.build_talos_query_params(
  File "/app/im_v2/talos/data/extract/extractor.py", line 68, in build_talos_query_params
    start_date = imv2tauti.timestamp_to_talos_iso_8601(start_timestamp)
  File "/app/im_v2/talos/utils.py", line 33, in timestamp_to_talos_iso_8601
    hdateti.dassert_has_UTC_tz(timestamp)
  File "/app/helpers/hdatetime.py", line 168, in dassert_has_UTC_tz
    dassert_has_specified_tz(datetime_, tz_zones)
  File "/app/helpers/hdatetime.py", line 147, in dassert_has_specified_tz
    dassert_has_tz(datetime_)
  File "/app/helpers/hdatetime.py", line 132, in dassert_has_tz
    hdbg.dassert_is_not(
  File "/app/helpers/hdbg.py", line 325, in dassert_is_not
    _dfatal(txt, msg, *args, only_warning=only_warning)
  File "/app/helpers/hdbg.py", line 134, in _dfatal
    dfatal(dfatal_txt)
  File "/app/helpers/hdbg.py", line 63, in dfatal
    raise assertion_type(ret)
AssertionError: 
################################################################################
* Failed assertion *
'None' is not 'None'
datetime_='2022-06-28 21:31:45' doesn't have timezone info
################################################################################


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "im_v2/talos/data/extract/download_realtime_for_one_exchange_periodically.py", line 59, in <module>
    _main(_parse())
  File "im_v2/talos/data/extract/download_realtime_for_one_exchange_periodically.py", line 53, in _main
    imvcdeexut.download_realtime_for_one_exchange_periodically(
  File "/app/im_v2/common/data/extract/extract_utils.py", line 314, in download_realtime_for_one_exchange_periodically
    raise RuntimeError(
RuntimeError: 5 consecutive downloads were failed
17:36:45 - [36mINFO [0m hcache.py clear_global_cache:297                       Before clear_global_cache: 'global mem' cache: path='/mnt/tmpfs/tmp.cache.mem', size=32.0 KB
17:36:45 - [33mWARN [0m hcache.py clear_global_cache:298                       Resetting 'global mem' cache '/mnt/tmpfs/tmp.cache.mem'
17:36:45 - [33mWARN [0m hcache.py clear_global_cache:308                       Destroying '/mnt/tmpfs/tmp.cache.mem' ...
17:36:45 - [36mINFO [0m hcache.py clear_global_cache:319                       After clear_global_cache: 'global mem' cache: path='/mnt/tmpfs/tmp.cache.mem', size=nan

<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
